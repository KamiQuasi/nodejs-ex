<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/public/components/rhd-search-query.html">
<link rel="import" href="/public/components/rhd-search-box.html">
<link rel="import" href="/public/components/rhd-search-result-count.html">
<link rel="import" href="/public/components/rhd-search-filters.html">
<link rel="import" href="/public/components/rhd-search-filter-group.html">
<link rel="import" href="/public/components/rhd-search-filter-item.html">
<link rel="import" href="/public/components/rhd-search-results.html">
<link rel="import" href="/public/components/rhd-search-sort-page.html">
<link rel="import" href="/public/components/rhd-search-active-filters.html">
<link rel="import" href="/public/components/rhd-search-recommended.html">

<dom-module id="new-rhd-search">
  <template>
    <style>
      :host {
        display: flex;
        flex-flow: column;
      }

      .hide { display: none; }
      .show { display: block; }

      .mobile { display: none; }

      rhd-search-box {
        
      }

      .content {
        display: flex;
        flex-direction: row;
      }

      rhd-search-filters {
        flex: 0 0 240px;
        align-self: auto;
      }
      
      rhd-search-results {
        flex: 1 1 auto;
        display: flex;
        flex-direction: column;
      }

      @media only screen and (max-width: 768px) {
        .content {
          flex-direction: column;
          position: relative;
        }

        rhd-search-filters { flex: none; align-self: flex-start; float: left; }
        rhd-search-sort-page { align-self: flex-end; position: absolute; top: 0;}
        rhd-search-results { flex: auto; }
        .mobile { display: block; }
        .desktop { display: none; }
      }
    </style>
    <rhd-search-query results="{{results}}" filters="[[filters]]" limit="10"></rhd-search-query>
    <rhd-search-box term="{{filters.term}}"></rhd-search-box>
    <rhd-search-result-count count="{{results.hits.total}}" term="{{filters.term}}" class="desktop"></rhd-search-result-count>
    <div class="content">
      <rhd-search-filters title="Filter By" filters="{{filters}}">
        <rhd-search-filter-group name="CONTENT TYPE">
        </rhd-search-filter-group>
        <rhd-search-filter-group name="PRODUCT">
          <rhd-search-filter-item value="eap" name="JBoss Enterprise Application Platform" filter="{{filters.target_product.0}}"></rhd-search-filter-item>
          <rhd-search-filter-item value="webserver" name="JBoss Web Server" filter="{{filters.target_product.1}}"></rhd-search-filter-item>
          <rhd-search-filter-item value="datagrid" name="JBoss Data Grid" filter="{{filters.target_product.2}}"></rhd-search-filter-item>
          <rhd-search-filter-item value="datavirt" name="JBoss Data Virtualization"></rhd-search-filter-item>
          <rhd-search-filter-item value="fuse" name="JBoss Fuse"></rhd-search-filter-item>
          <a href="#" onclick="return false;">Show More...</a>
          <div class="hide">
          <rhd-search-filter-item value="amq" name="JBoss A-MQ"></rhd-search-filter-item>
          <rhd-search-filter-item value="brms" name="JBoss BRMS"></rhd-search-filter-item>
          <rhd-search-filter-item value="bpmsuite" name="JBoss BPM Suite"></rhd-search-filter-item>
          <rhd-search-filter-item value="devstudio" name="JBoss Developer Studio"></rhd-search-filter-item>
          <rhd-search-filter-item value="cdk" name="Red Hat Container Development Kit"></rhd-search-filter-item>
          <rhd-search-filter-item value="developertoolset" name="Red Hat Developer Toolset"></rhd-search-filter-item>
          <rhd-search-filter-item value="rhel" name="Red Hat Enterprise Linux"></rhd-search-filter-item>
          <rhd-search-filter-item value="softwarecollections" name="Red Hat Software Collections"></rhd-search-filter-item>
          <rhd-search-filter-item value="mobileplatform" name="Red Hat Mobile Application Platform"></rhd-search-filter-item>
          <rhd-search-filter-item value="openshift" name="Red Hat OpenShift Container Platform"></rhd-search-filter-item>
          </div>
        </rhd-search-filter-group>
        <rhd-search-filter-group name="TOPIC">
        </rhd-search-filter-group>
      </rhd-search-filters>
      <rhd-search-results results="[[results]]" infinite>
        <rhd-search-sort-page sort="most recent" page-size="10" class="mobile"></rhd-search-sort-page>
        <rhd-search-result-count count="{{results.hits.total}}" term="{{filters.term}}" class="mobile"></rhd-search-result-count>
        <rhd-search-sort-page sort="most recent" page-size="10" class="desktop"></rhd-search-sort-page>
        <rhd-search-active-filters filters="{{filters}}"></rhd-search-active-filters>
        <rhd-search-recommended></rhd-search-recommended>
      </rhd-search-results>
    </div>
  </template>

  <script>
    class RHDSearchApplication extends Polymer.Element {
      static get is() { return 'new-rhd-search'; }
      static get properties() {
        return {
          filters: {
            type: Object,
            value: {term:'', target_product: []}
          }
        };
      }
    }

    window.customElements.define(RHDSearchApplication.is, RHDSearchApplication);
  </script>
</dom-module>
